<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <title>User Page</title>
    <style>
      body {
        font-family: Arial, sans-serif;
        margin: 1rem;
      }
      .channel-list {
        margin: 1rem 0;
        padding: 0;
        list-style: none;
      }
      .channel-list li {
        margin-bottom: 0.5rem;
      }
    </style>
  </head>
  <body>
    <h2 id="welcome-message"></h2>
    <p id="role-message"></p>

    <h3>Available Channels</h3>
    <ul id="channel-list" class="channel-list"></ul>

    <script>
      // Example of a normal user (not admin).
      // In a real application, you'd retrieve user data from your server or auth system.
      const user = {
        id: 456,
        name: "John",
        role: "user", // Not admin
      };

      // Populate user info on the page
      document.getElementById(
        "welcome-message"
      ).textContent = `Welcome, ${user.name}!`;
      document.getElementById(
        "role-message"
      ).textContent = `Your role: ${user.role}`;

      // Function to fetch and display channels
      function fetchChannels() {
        fetch("/api/channels")
          .then((response) => {
            if (!response.ok) {
              throw new Error("Network response was not ok");
            }
            return response.json();
          })
          .then((channels) => {
            const channelListEl = document.getElementById("channel-list");
            channelListEl.innerHTML = ""; // Clear previous list

            if (channels.length === 0) {
              channelListEl.innerHTML = "<li>No channels found.</li>";
              return;
            }

            // Display each channel in an <li>
            channels.forEach((channel) => {
              const li = document.createElement("li");
              li.textContent = channel.name;
              channelListEl.appendChild(li);
            });
          })
          .catch((error) => {
            console.error("Error fetching channels:", error);
            document.getElementById("channel-list").innerHTML =
              "<li>Error loading channels.</li>";
          });
      }

      // Fetch channels on page load
      fetchChannels();
    </script>
  </body>
</html>
